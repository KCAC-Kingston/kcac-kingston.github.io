<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <link rel="icon" href="images/KCAC_Logo.ico" />
    <title>Kingston Chinese Alliance Church 京士顿华人宣道会</title>
    <link
      rel="stylesheet"
      href="splash_style.css"
      type="text/css"
      media="all"
      title="no title"
      charset="utf-8"
    />
  </head>
  <body id="splash">
    <div id="wrapper">
      <div id="center_box">
        <div id="splash"></div>

        <b><h1>Welcome to KCAC<br>歡迎來到京士顿华人宣道会</h1></b>
        <br />
        <br />
		<center><table class='accpt'><td>
        <h2>Thanks. 
        <br>谢谢</h2><hr><div id="weekofsec"></div></td></table></center>
        Please save the screenshot of this page or bookmark this page.<br> You will need to show this when you're coming to church.
        <br>请保存本页面截图或将本页存为书签。你将需要在来教会时出示本页面。
      <br /><br />
        
		
		<a href="index.html" class="button">Start Over 重新開始</a>
		
      </div>
    </div><script src="acctoolbar.min.js"></script>
    
    <script>
      window.onload = function() {
        window.micAccessTool = new MicAccessTool({
    
          buttonPosition: 'right', // default is 'left'
        });
      }
   Date.prototype.getWeekNumber = function(){
  var d = new Date(Date.UTC(this.getFullYear(), this.getMonth(), this.getDate()));
  var dayNum = d.getUTCDay() || 7;
  d.setUTCDate(d.getUTCDate() + 4 - dayNum);
  var yearStart = new Date(Date.UTC(d.getUTCFullYear(),0,1));
  return Math.ceil((((d - yearStart) / 86400000) + 1)/7)
};
//change background colour according to week of the year
//document.write('The current ISO week number is ' + new Date().getWeekNumber() + '<hr>');
curWeek = new Date().getWeekNumber()
modWeek = curWeek % 5;
document.getElementById("weekofsec").innerText = 'This is the ' + new Date().getWeekNumber() + ' service of this year.';
//document.write(modWeek);

function getCookie(cname) {
  let name = cname + "=";
  let decodedCookie = decodeURIComponent(document.cookie);
  let ca = decodedCookie.split(';');
  for(let i = 0; i <ca.length; i++) {
    let c = ca[i];
    while (c.charAt(0) == ' ') {
      c = c.substring(1);
    }
    if (c.indexOf(name) == 0) {
      return c.substring(name.length, c.length);
    }
  }
  return "";
}
let fillingWoYear = getCookie('fillingWoY')
if(fillingWoYear != curWeek){
  window.location.href = "expire.html"
}
else{
  switch(modWeek){
  case 0:
  document.body.style.backgroundColor = "#F3FF00";
    break;
  case 1:
  document.body.style.backgroundColor = "#02F9B5";
    break;
  case 2:
  document.body.style.backgroundColor = "#F04CFE";
    break;
  case 3:
  document.body.style.backgroundColor = "#1BCF8B";
    break;
  case 4:
  document.body.style.backgroundColor = "#ECAA9B";
    break;

}
}


    </script>
  </body>
</html>
